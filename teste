// DOM Elements
const numbersButtons = document.querySelectorAll(".number");
const output = document.querySelector(".output");
const clearButton = document.querySelector("#clear");
const arithmeticOperatorButtons = document.querySelectorAll(
    ".arithmetic-operator"
);
const equalButton = document.querySelector("#equal");
const dotButton = document.querySelector("#dot");

// Variables
let numberShowed1 = "0";
let numberShowed2 = null;
let operation = null;

// Functions
const clearCalculator = () => {
    numberShowed1 = "0";
    numberShowed2 = null;
    operation = null;
};

const calculate = () => {
    const number1 = Number(numberShowed1);
    const number2 = Number(numberShowed2);
    let result = 0;
    switch (operation) {
        case "+":
            clearCalculator();
            result = number1 + number2;
            break;
        case "-":
            clearCalculator();
            result = number1 - number2;
            break;
        case "ร":
            clearCalculator();
            result = number1 * number2;
            break;
        case "รท":
            clearCalculator();
            result = number1 / number2;
            break;
        default:
            clearCalculator();
            alert("Erro!");
            break;
    }
    if (isNaN(result)) {
        numberShowed1 = "0";
        output.textContent = "Error";
        return;
    }
    numberShowed1 = result.toString();
    output.textContent = numberShowed1;
};

// Events
numbersButtons.forEach((numberButton) => {
    numberButton.addEventListener("click", (e) => {
        const value = e.target.textContent;

        // Conditional Variables
        const isInfinity = numberShowed1 === "Infinity" && operation === null;
        const isFirstResult =
            numberShowed1 === "0" &&
            numberShowed2 === null &&
            operation === null &&
            value !== ".";
        const isDotInvalid = numberShowed1.includes(".") && value === ".";
        const isFirstNumber = numberShowed1 && numberShowed2 === null && operation === null

        // First value (before operator)
        if (isInfinity) {
            numberShowed1 = "0";
        }
        if (isFirstResult) {
            numberShowed1 = value;
            output.textContent = numberShowed1;
            return;
        }
        if (isDotInvalid) {
            return;
        }
        if (isFirstNumber) {
            numberShowed1 += value;
            output.textContent = numberShowed1;
            return;
        }

        // Conditional variables
        const isFirstCharacterSecondNumber = numberShowed2 === null && operation !== null && value !== ".";

        // Second value (after operator)
        if (isFirstCharacterSecondNumber) {
            numberShowed2 = value;
            output.textContent += numberShowed2;
            return;
        }
        if (numberShowed2.includes(".") && value === ".") {
            return;
        }
        if (numberShowed2) {
            numberShowed2 += value;
            output.textContent += numberShowed2[numberShowed2.length - 1];
            return;
        }
    });
});

clearButton.addEventListener("click", () => {
    clearCalculator();
    output.textContent = numberShowed1;
});

arithmeticOperatorButtons.forEach((arithmeticOperatorButton) => {
    arithmeticOperatorButton.addEventListener("click", (e) => {
        if (operation !== null) {
            calculate();
        }
        const value = e.target.textContent;
        operation = value;
        output.textContent += operation;
    });
});

equalButton.addEventListener("click", calculate);
